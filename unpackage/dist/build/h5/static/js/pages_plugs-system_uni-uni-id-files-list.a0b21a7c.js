(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["pages_plugs-system_uni-uni-id-files-list"],{"0353":function(e,t,a){var n=a("24fb");t=n(!1),t.push([e.i,'@charset "UTF-8";uni-page-body[data-v-3aeb6122],\n.page-body[data-v-3aeb6122]{width:100%;height:100%}.page-body[data-v-3aeb6122]{display:grid;grid-template-columns:180px auto;grid-template-rows:35px auto 40px;grid-gap:8px 0;position:relative}.header[data-v-3aeb6122]{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-ms-flex-align:center;align-items:center;grid-column:1/-1;font-size:14px}.header .el-button[data-v-3aeb6122]{height:32px}.header-item[data-v-3aeb6122]{margin-left:20px;height:100%;display:-webkit-box;display:-ms-flexbox;display:flex;border-radius:4px;overflow:hidden}.header-item .search-input[data-v-3aeb6122]{width:200px}.header-item .el-button[data-v-3aeb6122]{height:32px}.nav[data-v-3aeb6122]{height:100%;grid-row:2/-1;border:1px solid #e4e2e2;display:grid;grid-template-rows:repeat(auto-fill,40px);color:#59607b;font-size:12px;overflow-y:auto;-webkit-box-sizing:border-box;box-sizing:border-box;padding-bottom:10px}.nav-list[data-v-3aeb6122]{cursor:pointer;border-bottom:1px solid #e4e2e2;-webkit-box-sizing:border-box;box-sizing:border-box;height:40px;overflow:hidden;-webkit-transition:all .3s;transition:all .3s;background-color:#f6f4f4;padding-left:10px;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-ms-flex-align:center;align-items:center}.nav-list > i[data-v-3aeb6122]{font-size:13px;place-self:center}.nav-list[data-v-3aeb6122]:hover{color:#108ee9}.nav-list .nav-name[data-v-3aeb6122]{-webkit-box-flex:1;-ms-flex:1;flex:1}.nav-list .nav-btn[data-v-3aeb6122]{width:44px;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-ms-flex-align:center;align-items:center}.nav-list .nav-btn .btn[data-v-3aeb6122]{width:22px;display:block}.selected-nav[data-v-3aeb6122]{background-color:#ecf6fd!important;color:#108ee9!important}.add-group[data-v-3aeb6122]{width:60%;margin:5px auto;padding:5px 0;text-align:center;border:1px dashed #108ee9;color:#108ee9;cursor:pointer}.add-group[data-v-3aeb6122]:hover{background-color:#108ee9;color:#fff;opacity:.9}.add-group[data-v-3aeb6122]:active{background-color:#108ee9;color:#fff}.main[data-v-3aeb6122]{display:grid;grid-template-columns:repeat(auto-fill,135px);grid-template-rows:repeat(auto-fill,180px);grid-gap:20px;place-content:start center;overflow-y:auto;min-width:700px}.update-img[data-v-3aeb6122],\n.content-item[data-v-3aeb6122]{width:135px;height:180px;border:1px solid #e4e2e2;cursor:pointer;background-color:initial;-webkit-transition:all .25s;transition:all .25s;position:relative;overflow:hidden}.choose-image[data-v-3aeb6122]{background-color:#ecf6fd!important;border:1px solid #daedff}.choose-image .tips[data-v-3aeb6122]{background-color:#ecf6fd}.content-item[data-v-3aeb6122]:hover{background-color:#ecf6fd;border:1px solid #daedff}.item-file[data-v-3aeb6122]{width:100%;height:150px;position:relative}.item-file uni-image[data-v-3aeb6122]{width:100%;height:100%}.item-file .suffix[data-v-3aeb6122]{position:absolute;top:2px;right:6px;font-size:12px;color:#a7a7a7}.item-file .duration[data-v-3aeb6122]{position:absolute;bottom:0;left:0;font-size:12px;color:#fff;background-color:#b2b2b2;padding:0 2px}.item-file .size[data-v-3aeb6122]{position:absolute;bottom:0;right:0;font-size:12px;color:#fff;background-color:#b2b2b2;padding:0 2px}.item-file .video-play-btn[data-v-3aeb6122]{position:absolute;top:54px;left:47px;background-color:rgba(66,66,66,.6);border-radius:50%}.item-file .other-icon[data-v-3aeb6122]{display:-webkit-box;display:-ms-flexbox;display:flex;width:100%;height:100%;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center}.content-item:hover > .tips[data-v-3aeb6122]{-webkit-transform:translateY(0)!important;transform:translateY(0)!important}.update-img[data-v-3aeb6122]{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column;color:#d5d5de}.update-img[data-v-3aeb6122]::before{line-height:1;font-size:45px;content:"+"}.update-img[data-v-3aeb6122]::after{content:"上传";font-size:12px}.tips[data-v-3aeb6122]{position:absolute;height:60px;right:0;bottom:0;left:0;background-color:#fff;-webkit-transition:all .4s;transition:all .4s;-webkit-transform:translateY(50%);transform:translateY(50%);display:grid;grid-template-columns:repeat(4,1fr);grid-template-rows:repeat(2,1fr);grid-gap:5px 0;font-size:13px;place-items:center}.title[data-v-3aeb6122]{text-align:center;grid-column:1/-1;width:100%;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.operation[data-v-3aeb6122]{height:100%;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center}.operation[data-v-3aeb6122]:hover{color:#108ee9}.footer[data-v-3aeb6122]{background-color:#f4faff;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-ms-flex-align:center;align-items:center;font-size:12px;color:#3091f2}.paging[data-v-3aeb6122]{-webkit-box-flex:1;-ms-flex:1;flex:1;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:end;-ms-flex-pack:end;justify-content:flex-end}.footer-item[data-v-3aeb6122]{padding:2px 9px;border:1px solid #3091f2;margin-left:8px;cursor:pointer;background-color:#fff}.no-selected .footer-item[data-v-3aeb6122]{pointer-events:none;color:#ced0d5;background-color:#fff;border-color:#ebeef5!important}.footer-label[data-v-3aeb6122]{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;color:#59607b}.footer-label .checkbox[data-v-3aeb6122]{margin:0;padding:0;outline:none}.num[data-v-3aeb6122]{min-width:50px;text-align:center;margin:0 10px;color:#3091f2}',""]),e.exports=t},"0595":function(e,t,a){"use strict";a.r(t);var n=a("95b5"),i=a("f506");for(var o in i)"default"!==o&&function(e){a.d(t,e,(function(){return i[e]}))}(o);var l,r=a("f0c5"),s=Object(r["a"])(i["default"],n["b"],n["c"],!1,null,"5a1726a2",null,!1,n["a"],l);t["default"]=s.exports},"0f47":function(e,t,a){"use strict";var n;Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;uni.vk;var i={props:{value:{Type:Object,default:function(){return{show:!1,mode:"",item:{}}}}},data:function(){return{page:{title:"添加分组",submitText:"确定",cancelText:"关闭",showCancel:!0,top:"14vh",width:"450px"},form1:{data:{},props:{action:"admin/system_uni/uni-id-files/categories/sys/add",columns:[{key:"name",title:"名称",type:"text"}],rules:{name:[{required:!0,message:"名称不能为空",trigger:"change"},{max:16,message:"最多16字",trigger:"change"}]},labelWidth:"60px"}}}},mounted:function(){n=this,n.init()},methods:{init:function(){var e=n,t=e.value;n.$emit("input",t)},onOpen:function(){n=this;var e=n.value.item;n.form1.data={_id:e._id,name:e.name}},onClose:function(){n.$refs.form1.resetForm()},onFormSuccess:function(){n.value.show=!1,n.$emit("success")}},watch:{"value.show":{handler:function(e,t){var a=this;e?a.onOpen():a.onClose()}}},filters:{},computed:{}};t.default=i},"3d99":function(e,t,a){"use strict";a.r(t);var n=a("c64e"),i=a("93b1");for(var o in i)"default"!==o&&function(e){a.d(t,e,(function(){return i[e]}))}(o);var l,r=a("f0c5"),s=Object(r["a"])(i["default"],n["b"],n["c"],!1,null,"0472c953",null,!1,n["a"],l);t["default"]=s.exports},"433f":function(e,t,a){"use strict";a.r(t);var n=a("0f47"),i=a.n(n);for(var o in n)"default"!==o&&function(e){a.d(t,e,(function(){return n[e]}))}(o);t["default"]=i.a},"51a2":function(e,t,a){"use strict";var n;Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;uni.vk;var i={props:{value:{Type:Object,default:function(){return{show:!1,mode:"",item:{}}}}},data:function(){return{page:{title:"修改文件名称",submitText:"确定",cancelText:"关闭",showCancel:!0,top:"14vh",width:"450px"},form1:{data:{},props:{action:"admin/system_uni/uni-id-files/files/kh/update",columns:[{key:"display_name",title:"名称",type:"text"}],rules:{display_name:[{required:!0,message:"名称不能为空",trigger:"change"},{max:32,message:"最多32字",trigger:"change"}]},labelWidth:"60px"}}}},mounted:function(){n=this,n.init()},methods:{init:function(){var e=n,t=e.value;n.$emit("input",t)},onOpen:function(){n=this;var e=n.value.item;n.form1.data={_id:e._id,display_name:e.display_name}},onClose:function(){},onFormSuccess:function(){n.value.item.display_name=n.form1.data.display_name,n.value.show=!1,n.$emit("success")}},watch:{"value.show":{handler:function(e,t){var a=this;e?a.onOpen():a.onClose()}}},filters:{},computed:{}};t.default=i},"62ec":function(e,t,a){"use strict";a.r(t);var n=a("efd7"),i=a("a555");for(var o in i)"default"!==o&&function(e){a.d(t,e,(function(){return i[e]}))}(o);var l,r=a("f0c5"),s=Object(r["a"])(i["default"],n["b"],n["c"],!1,null,"b4904466",null,!1,n["a"],l);t["default"]=s.exports},"674a":function(e,t,a){"use strict";var n;Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;uni.vk;var i={props:{value:{Type:Object,default:function(){return{show:!1,mode:"",item:{}}}}},data:function(){return{page:{title:"编辑视频信息",submitText:"确定",cancelText:"关闭",showCancel:!0,top:"14vh",width:"450px"},form1:{data:{},props:{action:"admin/system_uni/uni-id-files/files/kh/update",columns:[{key:"display_name",title:"名称",type:"text"},{key:"cover_image",title:"封面图",type:"image",limit:1}],rules:{display_name:[{required:!0,message:"名称不能为空",trigger:"change"},{max:32,message:"最多32字",trigger:"change"}]},labelWidth:"60px"}}}},mounted:function(){n=this,n.init()},methods:{init:function(){var e=n,t=e.value;n.$emit("input",t)},onOpen:function(){n=this;var e=n.value.item;n.form1.data={_id:e._id,display_name:e.display_name,cover_image:e.cover_image}},onClose:function(){},onFormSuccess:function(){n.$set(n.value.item,"display_name",n.form1.data.display_name),n.$set(n.value.item,"cover_image",n.form1.data.cover_image),n.value.show=!1,n.$emit("success")}},watch:{"value.show":{handler:function(e,t){var a=this;e?a.onOpen():a.onClose()}}},filters:{},computed:{}};t.default=i},"70cf":function(e,t,a){"use strict";var n;a.d(t,"b",(function(){return i})),a.d(t,"c",(function(){return o})),a.d(t,"a",(function(){return n}));var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("vk-data-dialog",{attrs:{title:e.page.title,top:e.page.top,width:e.page.width,"close-on-click-modal":!0,mode:"form"},model:{value:e.value.show,callback:function(t){e.$set(e.value,"show",t)},expression:"value.show"}},[a("vk-data-form",{ref:"form1",attrs:{"form-type":e.value.mode,rules:e.form1.props.rules,action:e.form1.props.action,columns:e.form1.props.columns,loading:e.form1.props.loading,labelWidth:e.form1.props.labelWidth,"show-cancel":e.page.showCancel,"cancel-text":e.page.cancelText,"submit-text":e.page.submitText},on:{"update:loading":function(t){arguments[0]=t=e.$handleEvent(t),e.$set(e.form1.props,"loading",t)},success:function(t){arguments[0]=t=e.$handleEvent(t),e.onFormSuccess.apply(void 0,arguments)}},model:{value:e.form1.data,callback:function(t){e.$set(e.form1,"data",t)},expression:"form1.data"}})],1)},o=[]},"72e1":function(e,t,a){"use strict";var n;a.d(t,"b",(function(){return i})),a.d(t,"c",(function(){return o})),a.d(t,"a",(function(){return n}));var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("vk-data-dialog",{attrs:{title:e.page.title,top:e.page.top,width:e.page.width,"close-on-click-modal":!0,mode:"form"},model:{value:e.value.show,callback:function(t){e.$set(e.value,"show",t)},expression:"value.show"}},[a("vk-data-form",{ref:"form1",attrs:{"form-type":e.value.mode,rules:e.form1.props.rules,action:e.form1.props.action,columns:e.form1.props.columns,loading:e.form1.props.loading,labelWidth:e.form1.props.labelWidth,"show-cancel":e.page.showCancel,"cancel-text":e.page.cancelText,"submit-text":e.page.submitText},on:{"update:loading":function(t){arguments[0]=t=e.$handleEvent(t),e.$set(e.form1.props,"loading",t)},success:function(t){arguments[0]=t=e.$handleEvent(t),e.onFormSuccess.apply(void 0,arguments)}},model:{value:e.form1.data,callback:function(t){e.$set(e.form1,"data",t)},expression:"form1.data"}})],1)},o=[]},7508:function(e,t,a){"use strict";var n;Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;uni.vk;var i={props:{value:{Type:Object,default:function(){return{show:!1,mode:"",item:{}}}}},data:function(){return{page:{title:"预览",submitText:"确定",cancelText:"关闭",showCancel:!0,top:"2vh",width:"600px"},styleCom:{}}},mounted:function(){n=this,n.init()},methods:{init:function(){var e=n,t=e.value;n.$emit("input",t)},onOpen:function(){n=this;var e=n.value.item,t=e.width,a=e.height,i=void 0===a?700:a,o=(e.type,t),l=i,r=700;i>r&&(l=r,o=t/i*r),n.styleCom={width:"".concat(o,"px"),height:"".concat(l,"px")},n.page.width=n.styleCom.width,n.$set(n.value.item,"play",!0)},onClose:function(){n.$set(n.value.item,"play",!1)}},watch:{"value.show":{handler:function(e,t){var a=this;e?a.onOpen():a.onClose()}}},filters:{},computed:{}};t.default=i},"7ff1":function(e,t,a){"use strict";var n;a.d(t,"b",(function(){return i})),a.d(t,"c",(function(){return o})),a.d(t,"a",(function(){return n}));var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-uni-view",{staticClass:"page-body"},[a("v-uni-view",{staticClass:"header"},[a("v-uni-view",{staticClass:"header-item",staticStyle:{"margin-left":"0"}},[a("el-button",{attrs:{type:"primary",round:!1,size:"small",icon:"el-icon-plus upload-btn"},on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e.uploadFile.apply(void 0,arguments)}}},[e._v("上传")])],1),a("v-uni-view",{staticClass:"header-item"},[a("el-radio-group",{attrs:{size:"small"},on:{change:function(t){arguments[0]=t=e.$handleEvent(t),e.getList.apply(void 0,arguments)}},model:{value:e.queryForm1.formData.type,callback:function(t){e.$set(e.queryForm1.formData,"type",t)},expression:"queryForm1.formData.type"}},[a("el-radio-button",{attrs:{label:"image"}},[e._v("图片")]),a("el-radio-button",{attrs:{label:"video"}},[e._v("视频")]),a("el-radio-button",{attrs:{label:"other"}},[e._v("其他")])],1)],1),a("v-uni-view",{staticClass:"header-item"},[a("el-input",{staticClass:"search-input input-border-radius-4004",attrs:{size:"small",type:"text",clearable:!0,placeholder:"请输入名称搜索..."},on:{clear:function(t){arguments[0]=t=e.$handleEvent(t),e.getList.apply(void 0,arguments)}},nativeOn:{keyup:function(t){if(!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter"))return null;arguments[0]=t=e.$handleEvent(t),e.getList.apply(void 0,arguments)}},model:{value:e.queryForm1.formData.display_name,callback:function(t){e.$set(e.queryForm1.formData,"display_name",t)},expression:"queryForm1.formData.display_name"}}),a("el-button",{staticStyle:{"border-radius":"0 4px 4px 0"},attrs:{type:"primary",loading:e.loading.main,round:!1,size:"small",icon:"el-icon-search"},on:{click:function(t){t.stopPropagation(),arguments[0]=t=e.$handleEvent(t),e.getList.apply(void 0,arguments)}}})],1),a("v-uni-view",{staticClass:"header-item"},[a("el-input",{staticClass:"search-input input-border-radius-4004",attrs:{size:"small",type:"text",clearable:!0,placeholder:"请输入URL搜索..."},on:{clear:function(t){arguments[0]=t=e.$handleEvent(t),e.getList.apply(void 0,arguments)}},nativeOn:{keyup:function(t){if(!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter"))return null;arguments[0]=t=e.$handleEvent(t),e.getList.apply(void 0,arguments)}},model:{value:e.queryForm1.formData.url,callback:function(t){e.$set(e.queryForm1.formData,"url",t)},expression:"queryForm1.formData.url"}}),a("el-button",{staticStyle:{"border-radius":"0 4px 4px 0"},attrs:{type:"primary",loading:e.loading.main,round:!1,size:"small",icon:"el-icon-search"},on:{click:function(t){t.stopPropagation(),arguments[0]=t=e.$handleEvent(t),e.getList.apply(void 0,arguments)}}})],1)],1),a("v-uni-view",{directives:[{name:"loading",rawName:"v-loading",value:e.loading.nav,expression:"loading.nav"}],staticClass:"nav"},[e._l(e.data.navList,(function(t,n){return a("v-uni-view",{key:n,staticClass:"nav-list",class:e.queryForm1.formData.category_id==t._id?"selected-nav":"",on:{click:function(a){a.stopPropagation(),arguments[0]=a=e.$handleEvent(a),e.queryByCategory(t._id)}}},[a("v-uni-text",{staticClass:"nav-name text-one"},[e._v(e._s(t.name))]),a("v-uni-view",{staticClass:"nav-btn"},[n>1?a("v-uni-view",{staticClass:"btn el-icon-edit",on:{click:function(a){a.stopPropagation(),arguments[0]=a=e.$handleEvent(a),e.vk.pubfn.openForm("updateCategory",{item:t})}}}):e._e(),n>1?a("el-popconfirm",{attrs:{title:"确定删除该分组吗？（组内图片不会删除）"},on:{confirm:function(a){arguments[0]=a=e.$handleEvent(a),e.deleteCategory(t._id,n)}}},[a("v-uni-view",{staticClass:"btn el-icon-delete",attrs:{slot:"reference"},on:{click:function(t){t.stopPropagation(),arguments[0]=t=e.$handleEvent(t),e.stop.apply(void 0,arguments)}},slot:"reference"})],1):e._e()],1)],1)})),a("v-uni-view",{staticClass:"add-group",on:{click:function(t){t.stopPropagation(),arguments[0]=t=e.$handleEvent(t),e.vk.pubfn.openForm("addCategory")}}},[e._v("添加分组")])],2),a("v-uni-view",{directives:[{name:"loading",rawName:"v-loading",value:e.loading.main,expression:"loading.main"}],staticClass:"main"},[e._l(e.data.content.rows,(function(t,n){return a("v-uni-view",{key:n,staticClass:"content-item",class:[e.selectedIds.includes(t._id)?"choose-image":""],on:{click:function(a){a.stopPropagation(),arguments[0]=a=e.$handleEvent(a),e.clickFile(t)}}},[a("v-uni-view",{staticClass:"item-file"},["image"===t.type?a("v-uni-image",{attrs:{src:t.url,mode:"aspectFit"}}):"video"===t.type?a("v-uni-view",{staticClass:"vk-contents"},[a("v-uni-image",{attrs:{src:e._f("coverImageFilter")(t),mode:"aspectFit"}}),a("v-uni-view",{staticClass:"duration"},[e._v(e._s(e._f("durationFilter")(t.duration)))]),a("v-uni-view",{staticClass:"size"},[e._v(e._s(e._f("sizeFilter")(t.size,["B","KB","MB","GB"],1024,1,"MB")))]),a("vk-data-icon",{staticClass:"video-play-btn",attrs:{name:t.play?"el-icon-video-pause":"el-icon-video-play",size:"40",color:"#d9d9d9"},on:{click:function(a){arguments[0]=a=e.$handleEvent(a),e.preview(t)}}})],1):a("v-uni-view",{staticClass:"other-icon",attrs:{src:t.url}},[a("vk-data-icon",{attrs:{name:"el-icon-document",size:"80",color:"#d5d5de"}}),a("v-uni-view",{staticClass:"size"},[e._v(e._s(e._f("sizeFilter")(t.size,["B","KB","MB","GB"],1024,1)))]),a("v-uni-view",{staticClass:"suffix"},[e._v(e._s(e._f("suffixFilter")(t.original_name)))])],1)],1),a("v-uni-view",{staticClass:"tips"},[a("v-uni-text",{staticClass:"title"},[e._v(e._s(t.display_name))]),"video"===t.type?a("v-uni-text",{staticClass:"operation",on:{click:function(a){arguments[0]=a=e.$handleEvent(a),e.vk.pubfn.openForm("updateVideo",{item:t})}}},[e._v("编辑")]):a("v-uni-text",{staticClass:"operation",on:{click:function(a){arguments[0]=a=e.$handleEvent(a),e.vk.pubfn.openForm("updateFileName",{item:t})}}},[e._v("改名")]),a("el-tooltip",{staticClass:"operation",attrs:{placement:"bottom"}},[a("v-uni-text",[e._v("链接")]),a("v-uni-view",{attrs:{slot:"content"},slot:"content"},[a("v-uni-view",{staticStyle:{"text-align":"center"}},[a("el-button",{staticStyle:{"margin-left":"0px"},attrs:{type:"text"},on:{click:function(a){arguments[0]=a=e.$handleEvent(a),e.copyFileUrl(t.url)}}},[e._v("复制")]),a("el-button",{staticStyle:{"margin-left":"30px"},attrs:{type:"text"},on:{click:function(a){arguments[0]=a=e.$handleEvent(a),e.preview(t)}}},[e._v("预览")])],1),a("v-uni-view",[e._v(e._s(t.url))])],1)],1),a("v-uni-text",{staticClass:"operation",on:{click:function(a){arguments[0]=a=e.$handleEvent(a),e.vk.pubfn.openForm("updateFileCategory",{item:t,list:e.data.navList})}}},[e._v("分组")]),a("el-popconfirm",{staticClass:"operation",attrs:{title:"确定删除吗？"},on:{confirm:function(a){arguments[0]=a=e.$handleEvent(a),e.deleteFile(t._id)}}},[a("v-uni-text",{attrs:{slot:"reference"},on:{click:function(t){t.stopPropagation(),arguments[0]=t=e.$handleEvent(t),e.stop.apply(void 0,arguments)}},slot:"reference"},[e._v("删除")])],1)],1)],1)})),a("v-uni-view",{staticClass:"update-img",on:{click:function(t){t.stopPropagation(),arguments[0]=t=e.$handleEvent(t),e.uploadFile.apply(void 0,arguments)}}})],2),a("v-uni-view",{staticClass:"footer",class:e.selectedIds.length?"":"no-selected"},[a("v-uni-label",{staticClass:"footer-label",style:e.data.content.rows.length?"":"pointer-events: none;",on:{click:function(t){t.stopPropagation(),arguments[0]=t=e.$handleEvent(t),e.selectAll.apply(void 0,arguments)}}},[a("v-uni-checkbox",{staticClass:"checkbox",staticStyle:{transform:"scale(0.6)"},attrs:{checked:!!e.selectedIds.length}}),a("v-uni-text",[e._v("已选")]),a("v-uni-text",{staticClass:"num"},[e._v(e._s(e.selectedIds.length)+" / "+e._s(e.data.content.rows.length))]),a("v-uni-text",[e._v("项")])],1),a("v-uni-text",{staticClass:"footer-item",on:{click:function(t){t.stopPropagation(),arguments[0]=t=e.$handleEvent(t),e.vk.pubfn.openForm("updateFileCategory",{item:{_id:e.selectedIds},list:e.data.navList})}}},[e._v("保存到组")]),a("el-popconfirm",{staticClass:"footer-item",attrs:{title:"确定删除吗？"},on:{confirm:function(t){arguments[0]=t=e.$handleEvent(t),e.deleteFile(e.selectedIds)}}},[a("v-uni-text",{attrs:{slot:"reference"},slot:"reference"},[e._v("删除")])],1),a("el-pagination",{staticClass:"paging",attrs:{background:!0,total:e.data.content.total,"current-page":e.queryForm1.pageIndex,"page-size":e.queryForm1.pageSize,"page-sizes":[30,50,100],"pager-count":5,layout:"total, sizes, prev, pager, next, jumper"},on:{"size-change":function(t){arguments[0]=t=e.$handleEvent(t),function(t){e.queryForm1.pageSize=t,e.getList()}.apply(void 0,arguments)},"current-change":function(t){arguments[0]=t=e.$handleEvent(t),function(t){e.queryForm1.pageIndex=t,e.getList()}.apply(void 0,arguments)}}})],1),a("addCategory",{on:{success:function(t){arguments[0]=t=e.$handleEvent(t),e.getNavList.apply(void 0,arguments)}},model:{value:e.formDatas.addCategory,callback:function(t){e.$set(e.formDatas,"addCategory",t)},expression:"formDatas.addCategory"}}),a("updateCategory",{model:{value:e.formDatas.updateCategory,callback:function(t){e.$set(e.formDatas,"updateCategory",t)},expression:"formDatas.updateCategory"}}),a("updateFileCategory",{on:{success:function(t){arguments[0]=t=e.$handleEvent(t),e.getList(),e.selectedIds=[]}},model:{value:e.formDatas.updateFileCategory,callback:function(t){e.$set(e.formDatas,"updateFileCategory",t)},expression:"formDatas.updateFileCategory"}}),a("updateFileName",{model:{value:e.formDatas.updateFileName,callback:function(t){e.$set(e.formDatas,"updateFileName",t)},expression:"formDatas.updateFileName"}}),a("updateVideo",{model:{value:e.formDatas.updateVideo,callback:function(t){e.$set(e.formDatas,"updateVideo",t)},expression:"formDatas.updateVideo"}}),a("preview",{model:{value:e.formDatas.preview,callback:function(t){e.$set(e.formDatas,"preview",t)},expression:"formDatas.preview"}})],1)},o=[]},"80f5":function(e,t,a){"use strict";var n=a("4ea4");a("99af"),a("4160"),a("caad"),a("c975"),a("d81d"),a("a434"),a("d3b7"),a("e25e"),a("ac1f"),a("2532"),a("3ca3"),a("1276"),a("159b"),a("ddb0"),Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i,o=n(a("2909")),l=n(a("98d3")),r=n(a("62ec")),s=n(a("3d99")),c=n(a("9032")),d=n(a("c2c7")),u=n(a("0595")),f=uni.vk,p={components:{addCategory:l.default,updateCategory:r.default,updateFileCategory:s.default,updateFileName:c.default,updateVideo:d.default,preview:u.default},data:function(){return{selectedIds:[],loading:{nav:!1,main:!1},data:{navList:[],content:{rows:[],total:0}},queryForm1:{pageIndex:1,pageSize:30,formData:{display_name:"",category_id:"",type:"image"},columns:[{key:"display_name",title:"名称",type:"text",mode:"%%"},{key:"url",title:"URL",type:"text",mode:"="},{key:"category_id",title:"分类id",type:"text",mode:"="},{key:"type",title:"文件类型",type:"text",mode:"="}]},formDatas:{}}},onLoad:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};i=this,f=i.vk,i.options=e,i.init(e)},onReady:function(){},onShow:function(){},onHide:function(){},methods:{init:function(e){i.getNavList(),i.getList()},getList:function(){var e=i,t=e.queryForm1,a=e.selectedIds;f.callFunction({url:"admin/system_uni/uni-id-files/files/kh/getList",loading:{that:i,name:"loading.main"},data:t,success:function(e){i.data.content=e,a.length=0}})},getNavList:function(){f.callFunction({url:"admin/system_uni/uni-id-files/categories/kh/getList",loading:{that:i,name:"loading.nav"},data:{pageIndex:1,pageSize:100},success:function(e){i.data.navList=[{_id:"",name:"全部"},{_id:"null",name:"未分组"}].concat((0,o.default)(e.rows))}})},queryByCategory:function(e){i.queryForm1.formData.category_id!=e&&(i.queryForm1.formData.category_id=e,i.getList())},deleteCategory:function(e,t){f.callFunction({url:"admin/system_uni/uni-id-files/categories/sys/delete",loading:{that:i,name:"loading.nav"},data:{_id:e},success:function(e){i.data.navList.splice(t,1)}})},deleteFile:function(e){f.callFunction({url:"admin/system_uni/uni-id-files/files/kh/delete",title:"请求中...",data:{_id:e},success:function(t){t.num>0&&("object"!==typeof e&&(e=[e]),e.map((function(e){var t=f.pubfn.getListIndex(i.data.content.rows,"_id",e);t>-1&&i.data.content.rows.splice(t,1)})),i.selectedIds=[])}})},uploadFile:function(){var e,t=i.queryForm1.formData.type,a=[];"image"===t?(a=["png","jpg","jpeg","gif","bmp","svg"],e="image"):"video"===t?(a=["avi","mp3","mp4","3gp","mov","rmvb","rm","flv","mkv"],e="video"):"other"===t&&(a=["txt","pdf","xls","xlsx","ppt","pptx","doc","docx","rar","zip"]),uni.chooseFile({extension:a,success:function(t){f.showLoading("上传中...");var a=[],n=function(n){a.push(new Promise((function(a,o){f.callFunctionUtil.uploadFile({filePath:t.tempFilePaths[n],file:t.tempFiles[n],needSave:!0,fileType:e,category_id:i.queryForm1.formData.category_id,addSuccess:function(e){a(e)}})})))};for(var o in t.tempFilePaths)n(o);Promise.all(a).then((function(e){f.hideLoading(),i.getList()})).catch((function(e){f.hideLoading(),console.error(e)}))}})},copyFileUrl:function(e){uni.setClipboardData({data:e,success:function(e){i.$message({message:"URL已复制",type:"success"})}})},preview:function(e){var t=e.type;e.url;"image"===t||"video"===t?f.pubfn.openForm("preview",{item:e}):f.toast("暂不支持该类型文件的预览")},clickFile:function(e){var t=i.selectedIds.indexOf(e._id);t>-1?i.selectedIds.splice(t,1):i.selectedIds.push(e._id)},selectAll:function(){i.selectedIds.length&&i.data.content.rows.length==i.selectedIds.length?i.selectedIds=[]:i.data.content.rows.forEach((function(e,t,a){i.selectedIds.includes(e._id)||i.selectedIds.push(e._id)}))},stop:function(){}},watch:{},filters:{suffixFilter:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=e.split(".");return t[t.length-1]},coverImageFilter:function(e){var t="",a=e.cover_image,n=e.url,i=e.width,o=void 0===i?600:i,l=e.height,r=void 0===l?600:l;return t=a||"".concat(n,"?x-oss-process=video/snapshot,t_1000,f_jpg,w_").concat(o,",h_").concat(r,",m_fast"),t},durationFilter:function(e){var t=parseInt(e),a=Math.floor(t/3600)<10?"0"+Math.floor(t/3600):Math.floor(t/3600),n=Math.floor(t/60%60)<10?"0"+Math.floor(t/60%60):Math.floor(t/60%60),i=Math.floor(t%60)<10?"0"+Math.floor(t%60):Math.floor(t%60);return"".concat(a,":").concat(n,":").concat(i)}},computed:{}};t.default=p},"81c6":function(e,t,a){"use strict";var n;Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;uni.vk;var i={props:{value:{Type:Object,default:function(){return{show:!1,mode:"",item:{},list:[]}}}},data:function(){return{page:{title:"修改分组",submitText:"确定",cancelText:"关闭",showCancel:!0,top:"14vh",width:"450px"},form1:{data:{},props:{action:"admin/system_uni/uni-id-files/files/kh/update",columns:[{key:"category_id",title:"分组",type:"select",placeholder:"请选择分组"}],rules:{},labelWidth:"60px"}}}},mounted:function(){n=this,n.init()},methods:{init:function(){var e=n,t=e.value;n.$emit("input",t)},onOpen:function(){n=this;var e=n.value.item;n.form1.data={_id:e._id,category_id:e.category_id}},onClose:function(){},onFormSuccess:function(){n.value.show=!1,n.$emit("success")}},watch:{"value.show":{handler:function(e,t){var a=this;e?a.onOpen():a.onClose()}}},filters:{},computed:{}};t.default=i},9032:function(e,t,a){"use strict";a.r(t);var n=a("70cf"),i=a("a278");for(var o in i)"default"!==o&&function(e){a.d(t,e,(function(){return i[e]}))}(o);var l,r=a("f0c5"),s=Object(r["a"])(i["default"],n["b"],n["c"],!1,null,"507d0fe1",null,!1,n["a"],l);t["default"]=s.exports},"93b1":function(e,t,a){"use strict";a.r(t);var n=a("81c6"),i=a.n(n);for(var o in n)"default"!==o&&function(e){a.d(t,e,(function(){return n[e]}))}(o);t["default"]=i.a},"95b5":function(e,t,a){"use strict";var n;a.d(t,"b",(function(){return i})),a.d(t,"c",(function(){return o})),a.d(t,"a",(function(){return n}));var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("vk-data-dialog",{attrs:{title:e.page.title,top:e.page.top,width:e.page.width,"close-on-click-modal":!0,"show-fullscreen":!1,"show-header":!1,"destroy-on-close":!0,mode:"form"},model:{value:e.value.show,callback:function(t){e.$set(e.value,"show",t)},expression:"value.show"}},["image"===e.value.item.type?a("v-uni-image",{staticStyle:{width:"100%",display:"block"},attrs:{src:e.value.item.url,mode:"widthFix"}}):"video"===e.value.item.type&&e.value.show?a("v-uni-view",{staticStyle:{margin:"auto"},style:e.styleCom},[a("v-uni-video",{staticStyle:{width:"100%",height:"100%",display:"block"},attrs:{src:e.value.item.url,autoplay:!0,"object-fit":"cover"}})],1):e._e()],1)},o=[]},"98d3":function(e,t,a){"use strict";a.r(t);var n=a("72e1"),i=a("433f");for(var o in i)"default"!==o&&function(e){a.d(t,e,(function(){return i[e]}))}(o);var l,r=a("f0c5"),s=Object(r["a"])(i["default"],n["b"],n["c"],!1,null,"4fd0c09d",null,!1,n["a"],l);t["default"]=s.exports},"9c7f":function(e,t,a){var n=a("0353");"string"===typeof n&&(n=[[e.i,n,""]]),n.locals&&(e.exports=n.locals);var i=a("4f06").default;i("594cb70c",n,!0,{sourceMap:!1,shadowMode:!1})},a278:function(e,t,a){"use strict";a.r(t);var n=a("51a2"),i=a.n(n);for(var o in n)"default"!==o&&function(e){a.d(t,e,(function(){return n[e]}))}(o);t["default"]=i.a},a555:function(e,t,a){"use strict";a.r(t);var n=a("cc7c"),i=a.n(n);for(var o in n)"default"!==o&&function(e){a.d(t,e,(function(){return n[e]}))}(o);t["default"]=i.a},afd9:function(e,t,a){"use strict";a.r(t);var n=a("80f5"),i=a.n(n);for(var o in n)"default"!==o&&function(e){a.d(t,e,(function(){return n[e]}))}(o);t["default"]=i.a},c2c7:function(e,t,a){"use strict";a.r(t);var n=a("ec71"),i=a("ca08");for(var o in i)"default"!==o&&function(e){a.d(t,e,(function(){return i[e]}))}(o);var l,r=a("f0c5"),s=Object(r["a"])(i["default"],n["b"],n["c"],!1,null,"d56cb5c8",null,!1,n["a"],l);t["default"]=s.exports},c5fc:function(e,t,a){"use strict";var n=a("9c7f"),i=a.n(n);i.a},c64e:function(e,t,a){"use strict";var n;a.d(t,"b",(function(){return i})),a.d(t,"c",(function(){return o})),a.d(t,"a",(function(){return n}));var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("vk-data-dialog",{attrs:{title:e.page.title,top:e.page.top,width:e.page.width,"close-on-click-modal":!0,mode:"form"},model:{value:e.value.show,callback:function(t){e.$set(e.value,"show",t)},expression:"value.show"}},[a("vk-data-form",{ref:"form1",attrs:{"form-type":e.value.mode,rules:e.form1.props.rules,action:e.form1.props.action,columns:e.form1.props.columns,loading:e.form1.props.loading,labelWidth:e.form1.props.labelWidth,"show-cancel":e.page.showCancel,"cancel-text":e.page.cancelText,"submit-text":e.page.submitText},on:{"update:loading":function(t){arguments[0]=t=e.$handleEvent(t),e.$set(e.form1.props,"loading",t)},success:function(t){arguments[0]=t=e.$handleEvent(t),e.onFormSuccess.apply(void 0,arguments)}},scopedSlots:e._u([{key:"category_id",fn:function(t){var n=t.form,i=t.keyName;return[a("vk-data-input-radio",{attrs:{width:"100%",localdata:e.value.list,props:{value:"_id",label:"name"},placeholder:"请选择分组",border:!0,"item-width":300},model:{value:n[i],callback:function(t){e.$set(n,i,t)},expression:"form[keyName]"}})]}}]),model:{value:e.form1.data,callback:function(t){e.$set(e.form1,"data",t)},expression:"form1.data"}})],1)},o=[]},ca08:function(e,t,a){"use strict";a.r(t);var n=a("674a"),i=a.n(n);for(var o in n)"default"!==o&&function(e){a.d(t,e,(function(){return n[e]}))}(o);t["default"]=i.a},cc7c:function(e,t,a){"use strict";var n;Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;uni.vk;var i={props:{value:{Type:Object,default:function(){return{show:!1,mode:"",item:{}}}}},data:function(){return{page:{title:"修改分组名称",submitText:"确定",cancelText:"关闭",showCancel:!0,top:"14vh",width:"450px"},form1:{data:{},props:{action:"admin/system_uni/uni-id-files/categories/sys/update",columns:[{key:"name",title:"名称",type:"text"}],rules:{name:[{required:!0,message:"名称不能为空",trigger:"change"},{max:16,message:"最多16字",trigger:"change"}]},labelWidth:"60px"}}}},mounted:function(){n=this,n.init()},methods:{init:function(){var e=n,t=e.value;n.$emit("input",t)},onOpen:function(){n=this;var e=n.value.item;n.form1.data={_id:e._id,name:e.name}},onClose:function(){},onFormSuccess:function(){n.value.item.name=n.form1.data.name,n.value.show=!1,n.$emit("success")}},watch:{"value.show":{handler:function(e,t){var a=this;e?a.onOpen():a.onClose()}}},filters:{},computed:{}};t.default=i},e012:function(e,t,a){"use strict";a.r(t);var n=a("7ff1"),i=a("afd9");for(var o in i)"default"!==o&&function(e){a.d(t,e,(function(){return i[e]}))}(o);a("c5fc");var l,r=a("f0c5"),s=Object(r["a"])(i["default"],n["b"],n["c"],!1,null,"3aeb6122",null,!1,n["a"],l);t["default"]=s.exports},ec71:function(e,t,a){"use strict";var n;a.d(t,"b",(function(){return i})),a.d(t,"c",(function(){return o})),a.d(t,"a",(function(){return n}));var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("vk-data-dialog",{attrs:{title:e.page.title,top:e.page.top,width:e.page.width,"close-on-click-modal":!0,mode:"form"},model:{value:e.value.show,callback:function(t){e.$set(e.value,"show",t)},expression:"value.show"}},[a("vk-data-form",{ref:"form1",attrs:{"form-type":e.value.mode,rules:e.form1.props.rules,action:e.form1.props.action,columns:e.form1.props.columns,loading:e.form1.props.loading,labelWidth:e.form1.props.labelWidth,"show-cancel":e.page.showCancel,"cancel-text":e.page.cancelText,"submit-text":e.page.submitText},on:{"update:loading":function(t){arguments[0]=t=e.$handleEvent(t),e.$set(e.form1.props,"loading",t)},success:function(t){arguments[0]=t=e.$handleEvent(t),e.onFormSuccess.apply(void 0,arguments)}},model:{value:e.form1.data,callback:function(t){e.$set(e.form1,"data",t)},expression:"form1.data"}})],1)},o=[]},efd7:function(e,t,a){"use strict";var n;a.d(t,"b",(function(){return i})),a.d(t,"c",(function(){return o})),a.d(t,"a",(function(){return n}));var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("vk-data-dialog",{attrs:{title:e.page.title,top:e.page.top,width:e.page.width,"close-on-click-modal":!0,mode:"form"},model:{value:e.value.show,callback:function(t){e.$set(e.value,"show",t)},expression:"value.show"}},[a("vk-data-form",{ref:"form1",attrs:{"form-type":e.value.mode,rules:e.form1.props.rules,action:e.form1.props.action,columns:e.form1.props.columns,loading:e.form1.props.loading,labelWidth:e.form1.props.labelWidth,"show-cancel":e.page.showCancel,"cancel-text":e.page.cancelText,"submit-text":e.page.submitText},on:{"update:loading":function(t){arguments[0]=t=e.$handleEvent(t),e.$set(e.form1.props,"loading",t)},success:function(t){arguments[0]=t=e.$handleEvent(t),e.onFormSuccess.apply(void 0,arguments)}},model:{value:e.form1.data,callback:function(t){e.$set(e.form1,"data",t)},expression:"form1.data"}})],1)},o=[]},f506:function(e,t,a){"use strict";a.r(t);var n=a("7508"),i=a.n(n);for(var o in n)"default"!==o&&function(e){a.d(t,e,(function(){return n[e]}))}(o);t["default"]=i.a}}]);